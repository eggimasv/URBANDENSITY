# Chart to generate WWTP Catchements and deensity
# ------------------------------------------------
import numpy as np
import matplotlib.pyplot as plt
from msilib.schema import Font
from matplotlib.font_manager import font_family_aliases


# Import for curve fit
import math, random, numpy, copy                    # Import Numpy for standard deviation
import numpy as np 
from scipy.optimize import curve_fit # Packate scipy
print("Sucseeful loading functions_transport")

def func2(params, x, data):
    m = params['m'].value
    c = params['c'].value
    d = params['d'].value
    model = np.power(x,m)*c + d
    return model - data #that's what you want to minimize

def createPowerFit(xList, YList):
    #additional import
    from scipy.optimize import curve_fit
    import numpy as np 
    import matplotlib.pyplot as plt
    from lmfit import minimize, Parameters, Parameter, report_fit
    
    # create a set of Parameters
    params = Parameters()
    params.add('m', value= 0)              # value is the initial condition
    params.add('c', value= 0) #, min=0.00001)
    params.add('d', value= 0)    # min=0 prevents that d becomes negative
    
    # do fit, here with leastsq model
    result = minimize(func2, params, args=(xList, YList))
    
    #R_squred = result.rsquared
    a = 1 - result.residual.var() / np.var(YList)
    print("R-Squared: " + str(a))
    b =  1 - result.redchi / np.var(YList, ddof=2)
    print("R-SQUARED: " + str(b))
    
    #----
    # http://stackoverflow.com/questions/22581887/python-lmfit-how-to-calculate-r-squared
    g = result.message
    print("G: " + str(g))
    
    #res = result.residual # Resdiuals
    #print("res: " + str(res))
    
    chi_square = result.chisqr
    print("chi_square: " + str(chi_square))
    
    reduced_chi_square = result.redchi
    print("reduced_chi_square: " + str(reduced_chi_square))
    #----
    
    f = result.params
    m = f['m'].value
    c = f['c'].value
    d = f['d'].value
    
    print("m value: " + str(m))
    print("c value: " + str(c))
    print("d value: " + str(d))
    report_fit(params)        # All Infos
    return m, c, d



# (ARA NR, Area; pop, Density)
inListWithCatchmentAndDensity = [(78200.0, 200765383.609, 319.000000001, 1.588919336), (121200.0, 78038814.4265, 159.0, 2.037447662), (353101.0, 76733911.6803, 225.0, 2.932210741), (398302.0, 136221220.763, 464.000000002, 3.406224063), (352101.0, 145650109.941, 499.0, 3.426018698), (360602.0, 71247297.9077, 246.326721188, 3.457348256), (374401.0, 93926090.4314, 327.778674865, 3.489751073), (377501.0, 81093482.0965, 284.961074167, 3.513982466), (374601.0, 203849886.276, 861.486641992, 4.226083506), (120800.0, 104161786.175, 459.0, 4.406606461), (329404.0, 98386918.6704, 443.766926301, 4.510426104), (392401.0, 54962120.3092, 249.093064071, 4.532086147), (382201.0, 87987714.2321, 399.409668929, 4.539379985), (122000.0, 96888839.4973, 466.67738479, 4.81662684), (78400.0, 236399286.32, 1168.32261521, 4.942157962), (375101.0, 73052842.7108, 388.318669008, 5.315586014), (374201.0, 31410705.5275, 169.330792548, 5.390862437), (369301.0, 28031055.2172, 157.0, 5.600930781), (329300.0, 107714167.316, 641.284942258, 5.953580279), (56700.0, 84847588.1745, 507.767430808, 5.984465107), (374301.0, 46254231.471, 286.734683144, 6.199101661), (385104.0, 32170220.3383, 213.439470939, 6.634690987), (360301.0, 152728854.134, 1017.98738729, 6.665324591), (84301.0, 11047649.1689, 80.2546269065, 7.264407629), (375301.0, 74934340.5337, 545.681330991, 7.282126287), (392701.0, 43248013.2067, 333.06516049, 7.701282343), (377601.0, 54009106.3194, 435.449701207, 8.062523728), (373401.0, 38588643.5932, 312.420798673, 8.096185032), (374101.0, 61390118.904, 499.037826026, 8.128960082), (384301.0, 198653973.656, 1708.0, 8.597864762), (121100.0, 60992954.073, 534.0, 8.755109637), (56500.0, 134584898.484, 1192.0, 8.856862942), (369401.0, 43037848.2719, 387.645114276, 9.007074699), (623300.0, 242952214.205, 2369.0, 9.750888699), (378801.0, 283385821.26, 2801.0, 9.884051318), (378902.0, 51031227.4339, 516.026756547, 10.11198011), (376201.0, 313732169.615, 3268.6249258, 10.41852013), (359501.0, 37858947.213, 394.815173536, 10.42858301), (382101.0, 173592956.959, 1863.59033107, 10.73540289), (376101.0, 43111345.7838, 469.006455621, 10.8789565), (385103.0, 22650143.4998, 250.122570731, 11.04286914), (352301.0, 29579100.6663, 335.652813551, 11.34763417), (541002.0, 10059208.7436, 114.684824605, 11.4009787), (628700.0, 113246049.001, 1301.0, 11.48825952), (504300.0, 76636976.8019, 885.122160017, 11.54954432), (556600.0, 31841904.1041, 382.000000001, 11.99677), (92402.0, 33428907.3182, 403.894353595, 12.08218832), (353201.0, 171114041.944, 2078.0, 12.14394784), (351101.0, 91466791.3034, 1116.52068116, 12.20684213), (359901.0, 24197813.9043, 297.529213572, 12.29570633), (377502.0, 13715680.3572, 170.264042823, 12.41382406), (371201.0, 124325220.798, 1659.0, 13.34403421), (160600.0, 172667636.478, 2405.44727958, 13.9310836), (398601.0, 133910259.755, 1881.0, 14.04672057), (71001.0, 10669022.0014, 151.329339236, 14.18399355), (507900.0, 75355393.113, 1072.0, 14.22592273), (375201.0, 56311978.7075, 807.999999998, 14.34863449), (361201.0, 67988967.7168, 1000.46785042, 14.71514988), (58400.0, 164473194.319, 2491.35603281, 15.1474898), (120200.0, 97197555.174, 1482.0, 15.24729709), (361401.0, 71044451.6074, 1167.05798808, 16.42715176), (643200.0, 41817259.4697, 688.999999999, 16.47645036), (100401.0, 108187612.456, 1806.49277533, 16.69777837), (541001.0, 54011062.1316, 909.819855422, 16.84506506), (506100.0, 94293393.2538, 1609.0, 17.06376178), (398701.0, 153778134.343, 2700.0, 17.55776276), (628900.0, 205559629.44, 3614.0, 17.58127318), (351501.0, 20341649.0857, 363.281711654, 17.85900986), (140400.0, 55969484.9235, 1000.10269492, 17.86871357), (356101.0, 191009833.676, 3476.0, 18.19801595), (58200.0, 22123779.8149, 403.0, 18.21569385), (581500.0, 18809525.5516, 346.0, 18.39493501), (79100.0, 77007474.7901, 1419.0, 18.42678265), (350501.0, 55687018.0818, 1031.08033501, 18.51563202), (212700.0, 171177400.62, 3261.66562927, 19.05430049), (511400.0, 17279023.799, 331.0, 19.15617478), (387101.0, 174991377.639, 3444.92191428, 19.68623804), (379001.0, 57295821.4826, 1195.97324345, 20.87365557), (549100.0, 20182209.9166, 429.787752315, 21.29537618), (671900.0, 17816030.4155, 392.999999999, 22.05878587), (57600.0, 170598721.084, 3811.6439672, 22.34274643), (359401.0, 14625512.2177, 333.075817363, 22.77361725), (629200.0, 88237078.3054, 2011.31475661, 22.79443965), (120600.0, 287242029.662, 6588.65332932, 22.93763673), (398202.0, 90987516.1877, 2122.0, 23.32188073), (541100.0, 61652484.9523, 1442.0, 23.38916268), (58902.0, 20124118.766, 478.0, 23.75259287), (121700.0, 16331801.4804, 387.999999999, 23.75733017), (630000.0, 242692203.342, 5807.99999998, 23.93154753), (389101.0, 162496553.503, 3926.0, 24.16051243), (380501.0, 13273746.8186, 332.0, 25.01177735), (90600.0, 36480300.185, 914.999999999, 25.08203045), (136700.0, 185535582.962, 4679.21295396, 25.22002992), (355101.0, 46292497.036, 1185.0, 25.59810068), (79400.0, 257057323.7, 6594.0, 25.65186591), (397201.0, 270791999.417, 6979.0, 25.77254873), (398101.0, 50883780.4723, 1314.56664033, 25.83468893), (628300.0, 13385312.1487, 348.0, 25.99864659), (387102.0, 18131446.8385, 473.078085726, 26.09157945), (500900.0, 12985486.0695, 365.999999999, 28.18531382), (335601.0, 91783569.9527, 2683.13045855, 29.2332327), (549200.0, 25981761.3838, 763.0, 29.36675419), (675100.0, 14814955.975, 464.394341637, 31.34631938), (542300.0, 29080198.86, 938.999999999, 32.29001303), (57102.0, 19026397.115, 618.654631005, 32.51559543), (350601.0, 10515635.1958, 345.61001152, 32.8662991), (120400.0, 312299.913545, 10.4821730367, 33.56444425), (672200.0, 7844436.57228, 266.28623369, 33.94587122), (378201.0, 234331397.136, 8396.21715654, 35.83052574), (378601.0, 96132486.5714, 3452.78284347, 35.91692014), (134800.0, 27981016.1253, 1020.0, 36.45328659), (84300.0, 229741352.593, 8457.74537309, 36.81420553), (642300.0, 25554116.3871, 951.999999999, 37.2542719), (541500.0, 34185489.2839, 1274.0, 37.26727412), (555600.0, 18138201.6657, 679.0, 37.43480266), (640400.0, 12849786.8446, 481.999999998, 37.51034985), (335702.0, 7967310.26288, 300.21764393, 37.68117897), (337200.0, 25045982.9471, 964.717356461, 38.51784769), (106603.0, 39249324.1574, 1572.17086239, 40.05599832), (295100.0, 12591776.7202, 514.0, 40.8202918), (56102.0, 88195560.4324, 3618.0, 41.02247304), (300202.0, 23962972.9205, 987.0, 41.18854548), (43500.0, 10825628.8215, 448.282995012, 41.40941856), (335400.0, 69029783.3508, 2997.12909905, 43.41791258), (391101.0, 28883177.8738, 1275.81128504, 44.17143053), (130103.0, 83258063.0764, 3700.1863003, 44.44237787), (674201.0, 24767461.223, 1111.0, 44.85724193), (329501.0, 105427967.143, 4858.37399183, 46.08240226), (121500.0, 13335019.1058, 631.000000001, 47.31901732), (678900.0, 7796116.77952, 372.0, 47.71606308), (679300.0, 22379736.769, 1071.0, 47.85579076), (140200.0, 74850773.3779, 3613.0, 48.26937434), (641300.0, 20889739.3044, 1030.29622617, 49.32068377), (629300.0, 49829561.0703, 2490.57564938, 49.98189018), (300600.0, 42925384.3644, 2152.04376278, 50.13452517), (671800.0, 8073150.61619, 404.999999999, 50.16628814), (677800.0, 13664922.4674, 688.0, 50.34788903), (120401.0, 3472441.39257, 175.517826963, 50.54594365), (547400.0, 10214490.2515, 520.552939843, 50.96220438), (373201.0, 50513996.9405, 2579.0, 51.05515612), (548600.0, 15774011.0391, 808.372806514, 51.24713077), (231000.0, 102945935.276, 5276.67440206, 51.25675325), (363201.0, 7569621.54236, 390.250872735, 51.5548724), (548700.0, 6363723.04983, 328.592027086, 51.63518659), (385102.0, 199584431.025, 10306.7851448, 51.64122819), (78500.0, 123309692.278, 6407.0, 51.95860829), (100100.0, 241151239.801, 12926.1594506, 53.60187848), (568500.0, 6442643.74024, 348.456696697, 54.08597941), (677500.0, 22741771.481, 1249.0, 54.92096344), (675000.0, 12386080.3074, 682.713766311, 55.11943645), (542500.0, 25014562.495, 1402.0, 56.04735243), (555100.0, 7541659.47946, 426.000000001, 56.48624168), (359201.0, 10128480.3293, 579.374132959, 57.20247403), (547900.0, 7140841.65521, 409.999999999, 57.41620103), (358201.0, 111542318.685, 6495.79600511, 58.2361572), (285500.0, 7184734.3018, 420.0, 58.45727655), (285100.0, 9504929.97666, 559.0, 58.81158529), (249200.0, 8519568.11402, 504.0, 59.15792834), (560401.0, 2286287.45993, 135.835289303, 59.41304044), (565400.0, 6842172.43279, 407.0, 59.48403142), (357301.0, 2119864.87517, 126.965509253, 59.89320864), (72200.0, 18547143.3344, 1130.51459037, 60.95356951), (555300.0, 23712104.8238, 1465.0, 61.7827903), (540200.0, 96562830.843, 5977.45008896, 61.90218365), (248000.0, 16306013.7918, 1014.0, 62.18564592), (566100.0, 8071776.96058, 510.138016774, 63.2002122), (679600.0, 5859871.6148, 376.030232025, 64.17038747), (543400.0, 12315694.9063, 793.000000001, 64.38938331), (555500.0, 15489273.3294, 998.000000001, 64.43168629), (392101.0, 42527470.4161, 2741.0695019, 64.45409226), (57300.0, 63774896.1615, 4129.50722467, 64.75129672), (366101.0, 143677604.213, 9314.74912727, 64.83090512), (545600.0, 15821166.2707, 1034.0, 65.35548532), (552001.0, 9192311.24966, 601.389620475, 65.42311331), (212400.0, 176460899.229, 11563.5129436, 65.53017124), (528100.0, 148360734.368, 9807.13388779, 66.10329835), (310200.0, 12446119.9428, 826.719992142, 66.42391331), (360501.0, 7414445.30863, 497.878941381, 67.14985689), (44400.0, 83058935.3337, 5695.0, 68.56577173), (210100.0, 5593413.55316, 388.242508914, 69.41065688), (643700.0, 18233860.5086, 1267.0, 69.48610797), (56300.0, 101589356.372, 7294.0666543, 71.79951635), (650800.0, 6384067.14815, 458.571437187, 71.83060995), (160200.0, 550980866.631, 39883.8511738, 72.38699851), (57400.0, 7575757.25479, 549.0, 72.46800307), (350602.0, 31996280.5388, 2325.26825731, 72.67308006), (372201.0, 68513143.9195, 4983.0, 72.73056986), (553900.0, 8956563.64455, 655.000000001, 73.1307258), (680400.0, 9538478.6873, 697.751548262, 73.15124048), (329200.0, 95448057.4713, 7034.00631183, 73.69459891), (551900.0, 15273746.1116, 1130.97136671, 74.04675699), (284700.0, 3960132.94131, 294.738709197, 74.4264684), (549900.0, 8819401.44056, 657.447060155, 74.54554196), (553000.0, 5764924.42002, 431.999999999, 74.93593472), (17102.0, 32445104.954, 2441.91377962, 75.26293359), (540500.0, 15217096.2978, 1150.54991105, 75.60903135), (57500.0, 17295235.8797, 1314.0, 75.97467934), (261900.0, 16331218.8396, 1266.0, 77.52023976), (90200.0, 170897774.505, 13412.1427394, 78.48049969), (170400.0, 5488262.10641, 431.368528456, 78.59838326), (542800.0, 18886007.4765, 1485.0, 78.62964165), (295200.0, 21599757.7319, 1719.0, 79.58422596), (30800.0, 4515408.69206, 362.033903755, 80.17743873), (120101.0, 299368323.687, 24055.3466707, 80.35368062), (675400.0, 20390382.4552, 1639.0, 80.38103275), (200400.0, 47763967.1527, 3862.0, 80.85593032), (547100.0, 3745299.00531, 305.0, 81.43542066), (550000.0, 13470605.9002, 1108.0, 82.25316724), (140100.0, 349869118.052, 29141.8973051, 83.29371128), (95200.0, 25187809.4874, 2119.79173774, 84.15943192), (250200.0, 4797599.55663, 404.0, 84.20877883), (329100.0, 118272681.268, 10100.2330737, 85.39785321), (340603.0, 57975463.2639, 4956.78336178, 85.49795177), (286600.0, 6948136.2696, 596.0, 85.77839825), (310100.0, 145392372.786, 12510.8065746, 86.04857555), (340301.0, 8029195.06548, 691.012063346, 86.06243312), (671700.0, 7761659.27707, 668.162034119, 86.08494785), (58800.0, 4235826.1236, 366.000000001, 86.40581302), (463500.0, 25017126.2713, 2162.0, 86.42079736), (242900.0, 13026822.9466, 1129.0, 86.66733283), (556500.0, 5114201.16775, 446.0, 87.20814559), (21101.0, 10656383.0421, 931.251167188, 87.38904781), (650200.0, 58338559.5636, 5148.89161679, 88.2588061), (137000.0, 22798684.3181, 2047.0, 89.78588288), (542100.0, 11179651.1597, 1013.9339392, 90.69459545), (568900.0, 8723959.50162, 793.078246946, 90.90806151), (483700.0, 37188928.2596, 3438.4543548, 92.45908704), (568200.0, 6024862.61028, 557.146229803, 92.47451201), (95600.0, 336862021.918, 31291.0342481, 92.88976558), (137100.0, 17364716.6172, 1619.01292867, 93.23578175), (278800.0, 12488558.3367, 1167.0, 93.44553379), (67100.0, 4157450.89559, 392.687104366, 94.45381659), (643100.0, 11525985.1024, 1098.0, 95.26300704), (3701.0, 26219808.8618, 2513.97201445, 95.88063848), (373402.0, 8579368.74956, 835.579201328, 97.3940188), (335200.0, 56216017.0235, 5486.25778205, 97.59243135), (2801.0, 36207228.2637, 3542.35365762, 97.83553803), (69000.0, 57350786.7835, 5621.0, 98.01086115), (49700.0, 5442209.65497, 539.999999999, 99.22440226), (571900.0, 23139845.1659, 2298.0, 99.30922111), (453400.0, 15530103.3319, 1553.0, 99.99933463), (44800.0, 76876812.0849, 7723.71700498, 100.4687473), (525500.0, 7559280.58405, 760.976417901, 100.667836), (626603.0, 31363116.9458, 3164.96128318, 100.9134803), (130101.0, 126544521.286, 12778.3587834, 100.9791546), (300501.0, 829272.956035, 84.5793553897, 101.9921785), (628500.0, 15336706.0061, 1578.68524339, 102.935092), (560402.0, 16228000.366, 1682.1647107, 103.6581632), (449700.0, 6717088.56226, 697.214548388, 103.797135), (339100.0, 63004199.8173, 6543.60744082, 103.8598611), (288300.0, 7332144.78533, 769.000000001, 104.8806349), (4201.0, 23632047.1417, 2544.77681837, 107.6832998), (72500.0, 6585988.87555, 712.511208552, 108.1859113), (329800.0, 43948799.9183, 4777.77256166, 108.7122418), (202900.0, 17514811.4703, 1914.63869246, 109.315404), (545200.0, 19019062.9545, 2084.02396081, 109.575533), (284400.0, 8859590.68326, 971.761315227, 109.6846739), (227900.0, 4762548.17426, 524.000000001, 110.0251338), (509700.0, 22805833.2524, 2534.0, 111.1119235), (540900.0, 59540435.2764, 6649.0, 111.6720086), (651000.0, 41032910.839, 4587.53832071, 111.8014352), (416700.0, 29281903.9376, 3286.0, 112.2194789), (289400.0, 3712038.02395, 417.0, 112.3372113), (245700.0, 50707238.7764, 5700.55313296, 112.4208943), (337600.0, 12560580.926, 1415.25689114, 112.6744774), (209600.0, 98648210.2116, 11251.3795343, 114.0555871), (327400.0, 41516450.3155, 4738.00000001, 114.123437), (32300.0, 9688964.15493, 1107.04912986, 114.2587703), (286500.0, 5911601.17405, 683.0, 115.5355343), (297100.0, 102459919.715, 12024.5912581, 117.358976), (327600.0, 41724502.2926, 4987.0, 119.5220968), (541300.0, 52406439.7948, 6286.84375288, 119.9631911), (3901.0, 9464593.40641, 1138.41411726, 120.2813548), (674300.0, 10807872.1476, 1332.0, 123.2435008), (431300.0, 19289092.0876, 2388.0, 123.8005391), (3501.0, 32429436.7628, 4017.46840639, 123.8833852), (511302.0, 361798528.522, 44828.4501405, 123.9044568), (293800.0, 11381727.1907, 1418.0, 124.5856605), (511301.0, 187916446.47, 23426.6492508, 124.6652419), (483100.0, 47499082.949, 5967.15545206, 125.6267507), (288700.0, 3990723.1441, 503.0, 126.0423191), (553300.0, 5012551.00269, 635.000000002, 126.6820028), (680000.0, 119771778.232, 15174.3973764, 126.6942647), (245400.0, 7817915.84535, 992.0, 126.8880376), (647600.0, 83687188.4144, 10737.7854321, 128.3085934), (262200.0, 9675887.08196, 1257.66374885, 129.9791676), (240700.0, 142754227.437, 18608.6812632, 130.3546774), (150900.0, 158763186.28, 20732.6330153, 130.588416), (217300.0, 82009192.1419, 10725.3475685, 130.782261), (325600.0, 17661250.4231, 2328.80529808, 131.8595933), (567500.0, 73155783.617, 9653.7858574, 131.962032), (327200.0, 22296992.1086, 2989.0, 134.053956), (59300.0, 176443291.178, 23723.2492435, 134.4525433), (113400.0, 282379063.698, 38203.5559475, 135.2917438), (255500.0, 8296935.66188, 1125.20354847, 135.6167619), (109800.0, 40548679.0484, 5524.88911679, 136.2532454), (131102.0, 14367136.144, 1960.0, 136.4224561), (284100.0, 3964053.53622, 541.000000001, 136.4764615), (333201.0, 51571213.8899, 7051.91641835, 136.7413308), (74000.0, 11812822.3489, 1619.14307482, 137.0665728), (562200.0, 25997312.0224, 3569.67837648, 137.3095177), (30400.0, 10647654.6948, 1462.39523157, 137.3443517), (563000.0, 7631294.76177, 1058.94348443, 138.763279), (70400.0, 72121444.8301, 10031.0, 139.0848453), (670900.0, 235647544.117, 32780.2426471, 139.1070837), (641402.0, 1776575.15975, 250.0, 140.7201934), (549602.0, 7823146.29341, 1112.0, 142.1422991), (17101.0, 31174812.6513, 4438.03740033, 142.3597136), (551400.0, 6892940.78328, 990.000000002, 143.6252002), (247900.0, 12777450.3815, 1845.84254645, 144.4609442), (3801.0, 8927277.08643, 1294.0, 144.9490127), (288100.0, 3475777.98375, 504.0, 145.0035078), (331200.0, 16454425.8863, 2391.81837757, 145.3601842), (49602.0, 28792024.1456, 4203.99999999, 146.0126589), (10001.0, 12884794.2198, 1882.0, 146.0636443), (66700.0, 450628433.171, 66716.7492865, 148.0526846), (103500.0, 50373041.1625, 7471.0, 148.3134595), (247200.0, 6229106.545, 924.0, 148.3358798), (500500.0, 325034483.005, 48352.0050197, 148.7596164), (662002.0, 16849273.2006, 2527.20503927, 149.9889645), (255600.0, 19476817.0889, 2936.59419383, 150.7738241), (227200.0, 3927711.19066, 597.352048028, 152.0865509), (645500.0, 62532181.062, 9661.81509474, 154.509485), (423400.0, 33452337.2472, 5207.0, 155.6542959), (286001.0, 1927901.067, 301.531269954, 156.4039126), (302501.0, 16836220.0271, 2636.76156188, 156.6124437), (641401.0, 29684464.0329, 4700.0, 158.3319812), (412100.0, 37410355.2591, 5944.67311128, 158.9044817), (261801.0, 5994948.96944, 953.289092142, 159.0153806), (416900.0, 140295863.438, 22373.0, 159.470133), (75100.0, 50383673.6267, 8045.31453136, 159.680983), (60400.0, 3413109.75174, 553.339569118, 162.1218213), (548200.0, 5806629.87521, 944.000000001, 162.5727867), (86900.0, 86536838.921, 14072.0543607, 162.613455), (342200.0, 93951530.249, 15527.1301712, 165.2674537), (221900.0, 11938784.3169, 1982.0, 166.0135528), (545100.0, 19902960.7026, 3309.44646761, 166.2791038), (302100.0, 26834667.7689, 4469.99999999, 166.575567), (69600.0, 38801652.9513, 6515.17971717, 167.9098498), (339200.0, 56260565.4149, 9459.91030029, 168.1446006), (296400.0, 41704929.8009, 7043.10198732, 168.8793632), (551300.0, 15540406.3385, 2665.8305499, 171.541882), (44600.0, 24827096.1401, 4269.39602039, 171.9651785), (34500.0, 78263783.4847, 13482.0952266, 172.2648028), (459100.0, 80968733.709, 13951.4075324, 172.3061099), (108300.0, 16737170.7945, 2888.31086596, 172.5686439), (564400.0, 2923477.73488, 506.0660608, 173.1041269), (14001.0, 10556880.1204, 1842.9131907, 174.56987), (549800.0, 15310961.0803, 2691.0, 175.7564392), (430700.0, 4777679.6439, 840.0, 175.8175647), (423900.0, 33005672.2773, 5845.0, 177.0907725), (296300.0, 34038675.0754, 6057.99530231, 177.9738867), (423500.0, 5521675.91401, 1001.0, 181.28554), (422900.0, 22617459.1159, 4116.0, 181.9833067), (285300.0, 5060327.51955, 921.238684772, 182.0511975), (262100.0, 10113219.4202, 1846.05900402, 182.5392021), (661100.0, 19711052.3968, 3599.41132023, 182.6087845), (61100.0, 35414267.8677, 6482.58893932, 183.0502035), (565200.0, 3042343.11824, 558.000000001, 183.411265), (516300.0, 50446648.8966, 9263.19329733, 183.6235607), (220200.0, 2628790.33805, 485.488379209, 184.6812856), (279300.0, 118726745.735, 21950.988155, 184.8866321), (570800.0, 2133553.02521, 396.0, 185.6058862), (224300.0, 66034371.2512, 12256.5975325, 185.6093622), (542200.0, 23965461.2888, 4457.03292286, 185.9773475), (675700.0, 11658130.3076, 2180.75127568, 187.0584063), (220000.0, 11257161.0782, 2107.0, 187.1697478), (540700.0, 18571971.8369, 3479.49531997, 187.3519597), (454200.0, 26963009.0746, 5051.89801268, 187.3640289), (60700.0, 50058959.1092, 9418.25109626, 188.1431669), (254501.0, 25410680.7568, 4853.69537119, 191.0100488), (518100.0, 7189330.48975, 1374.0, 191.1165444), (337700.0, 54006446.9261, 10359.4262576, 191.8183263), (427200.0, 11830606.447, 2285.0, 193.1430997), (432100.0, 28566697.6632, 5537.0, 193.8270942), (13201.0, 10114830.3912, 1965.80594025, 194.3488783), (99200.0, 39932597.4107, 7775.0, 194.7030873), (411800.0, 6913108.73364, 1347.37321326, 194.9012037), (494100.0, 13791979.9264, 2696.68815197, 195.5258176), (220600.0, 98737697.9621, 19376.577612, 196.2429549), (226500.0, 40212425.9641, 7895.48303754, 196.3443599), (94400.0, 593013723.946, 116586.871822, 196.6006302), (431100.0, 6395557.03311, 1266.0, 197.9499195), (150200.0, 69877950.1526, 13905.3669846, 198.9950614), (551202.0, 6272300.08521, 1253.0, 199.7672278), (21801.0, 37701679.5337, 7701.6987427, 204.2799907), (561101.0, 16017082.2865, 3288.0, 205.2808334), (423700.0, 10870921.5469, 2232.0, 205.3183799), (216100.0, 122804153.527, 25980.0109743, 211.5564517), (327100.0, 100956543.309, 21360.0, 211.5761822), (201700.0, 42055874.1247, 8964.22483847, 213.1503631), (201300.0, 33173559.0883, 7075.70477309, 213.2935075), (413500.0, 15549808.5798, 3317.0, 213.314523), (49200.0, 10953762.9563, 2381.0, 217.368224), (394201.0, 68991618.6657, 15030.0, 217.8525492), (218400.0, 4365104.34865, 963.000000001, 220.6132828), (414400.0, 38988563.3044, 8608.0, 220.7826929), (98123.0, 17371175.5576, 3899.31873684, 224.4706309), (442600.0, 19623002.3348, 4422.82291241, 225.3897154), (325400.0, 34533975.3031, 7802.36974607, 225.9331478), (480100.0, 20541938.4989, 4647.0, 226.2201301), (247801.0, 6334052.44678, 1435.2742776, 226.5965256), (103300.0, 32944766.1403, 7476.0, 226.9252715), (486400.0, 15633721.0481, 3556.44004135, 227.4851925), (99400.0, 66936631.4208, 15289.045893, 228.4107456), (551500.0, 13939011.75, 3187.08692416, 228.6451135), (21701.0, 15299303.2702, 3534.70349753, 231.0368933), (100900.0, 25650517.2197, 5942.52607613, 231.6727583), (3001.0, 25593725.1739, 6017.60171404, 235.1201974), (432300.0, 37895564.2594, 9012.0, 237.8114741), (547300.0, 3153105.20017, 751.999999999, 238.4950556), (18001.0, 12483046.7951, 2983.64313091, 239.0156169), (103100.0, 49460994.4063, 11964.0, 241.8875751), (494600.0, 111637389.784, 27053.8252743, 242.3365982), (401.0, 13359305.9133, 3255.99999999, 243.725237), (137200.0, 112964644.371, 27571.9818486, 244.0762063), (170500.0, 7935415.50089, 1940.0, 244.473651), (412200.0, 5751976.37786, 1408.0, 244.7854281), (552702.0, 1752148.14955, 430.484426691, 245.6895136), (340500.0, 13968384.3503, 3497.68202208, 250.3998984), (548000.0, 2886803.88586, 723.238247815, 250.5325185), (342600.0, 22176251.5684, 5603.94416461, 252.7002432), (701.0, 23629169.1313, 6005.02385657, 254.1360563), (282300.0, 46949688.8628, 11931.9427149, 254.1431691), (227400.0, 51756544.4908, 13156.0, 254.1900764), (425400.0, 72493250.7878, 18473.0, 254.8237222), (36000.0, 34976657.5622, 8932.26742383, 255.3779591), (520300.0, 2849882.93884, 733.907720874, 257.5220585), (329600.0, 56728780.9485, 14653.8010135, 258.3133423), (390101.0, 182125296.34, 47073.3985273, 258.4671074), (257800.0, 45709391.046, 11837.653307, 258.9763949), (300700.0, 6742798.0384, 1773.44278012, 263.0128872), (333800.0, 76230790.8679, 20137.8387589, 264.1693537), (441600.0, 75454516.7015, 19939.5118165, 264.258691), (474600.0, 68415715.8292, 18126.7310768, 264.9498124), (32101.0, 144493898.175, 38539.4131678, 266.7200045), (102300.0, 8754606.59176, 2365.0, 270.1434925), (286100.0, 97206643.8043, 26354.3210504, 271.1164589), (30600.0, 116595260.943, 31877.257377, 273.4009695), (541200.0, 2192249.41617, 611.156247133, 278.7804356), (289100.0, 18894480.9955, 5323.0, 281.7224777), (552701.0, 1911245.76918, 542.515573311, 283.8544273), (110200.0, 33377286.0465, 9561.06513217, 286.4542407), (447100.0, 25583299.3715, 7331.22093903, 286.5627624), (414500.0, 27175180.3386, 7886.28087622, 290.2016023), (302401.0, 23786939.8431, 6918.66785326, 290.8599382), (404300.0, 37031905.7035, 10843.0, 292.8015665), (563900.0, 4386882.06973, 1306.0, 297.7057462), (455100.0, 45080353.1383, 13655.0951418, 302.9056827), (254600.0, 133947354.042, 40818.8725639, 304.7381776), (255400.0, 4891874.2889, 1499.46740839, 306.5220649), (110400.0, 103972651.618, 32111.823903, 308.848754), (626601.0, 115022252.112, 35969.4594598, 312.7173986), (427600.0, 35594133.675, 11200.0, 314.6585924), (325100.0, 36593170.2381, 11544.9494936, 315.4946516), (5801.0, 12309007.4383, 3890.0, 316.028731), (414100.0, 71994453.5906, 22773.5206006, 316.3232647), (257500.0, 11324114.8037, 3583.0, 316.4044221), (420800.0, 42810984.9459, 13635.7191238, 318.5098203), (22401.0, 34625523.7878, 11322.0468273, 326.9855756), (106700.0, 6228314.9735, 2050.0, 329.1419925), (551800.0, 18812735.9562, 6208.98292598, 330.0414645), (12001.0, 27937672.824, 9231.99546585, 330.4496951), (106902.0, 11816177.5167, 3926.36404385, 332.2871579), (469100.0, 30025804.2722, 10054.4428572, 334.8600679), (40100.0, 97886674.7897, 33218.2139942, 339.3537891), (254400.0, 2510078.60059, 859.0, 342.2203591), (645700.0, 44378143.2219, 15199.7452972, 342.5052108), (134600.0, 22567253.8855, 7830.41011015, 346.9810793), (303401.0, 4028282.09474, 1404.68230012, 348.7050477), (407900.0, 33339616.7086, 11654.0, 349.5541086), (640200.0, 10781322.9219, 3772.0, 349.8643003), (430900.0, 20750318.5337, 7277.0, 350.6934117), (469600.0, 11849351.6629, 4173.30958052, 352.1972931), (21901.0, 7896865.67613, 2790.12562655, 353.320639), (19501.0, 14040603.4876, 4973.79883715, 354.2439498), (570501.0, 5308033.22544, 1917.0, 361.150716), (456600.0, 84184500.1606, 30540.9990006, 362.7864861), (2501.0, 8983144.92892, 3283.0, 365.4622102), (41100.0, 82260651.0812, 30189.6751645, 367.0001972), (404100.0, 27347291.6103, 10087.0, 368.8482261), (6801.0, 40969965.6268, 15307.0, 373.6151536), (150700.0, 14303811.3651, 5374.0, 375.7040598), (61600.0, 47761715.3254, 17986.6931783, 376.5922781), (253400.0, 224735766.214, 84858.4885452, 377.5922719), (9401.0, 15560019.3764, 5897.99999999, 379.0483712), (427100.0, 56544846.2115, 21467.6749123, 379.6574993), (526200.0, 75164089.5687, 28689.8602572, 381.6963715), (5501.0, 9110389.94137, 3482.5569558, 382.2621181), (134400.0, 62614381.3002, 24006.2342378, 383.3980907), (419800.0, 21876961.2248, 8390.38201245, 383.5259352), (571700.0, 9446941.72453, 3629.7909723, 384.2292118), (1001.0, 13225952.0076, 5154.3872516, 389.7176739), (423600.0, 20205238.4262, 7894.0, 390.6907621), (420300.0, 80853656.0478, 32383.0, 400.5137378), (404700.0, 9370155.84126, 3775.0, 402.8748362), (300102.0, 39896089.2389, 16239.9273171, 407.0556194), (11301.0, 10868417.3877, 4538.59097696, 417.594468), (517800.0, 26667937.6783, 11370.0, 426.3546787), (549601.0, 15997749.8099, 6830.1697251, 426.9456521), (19601.0, 7273690.76297, 3122.95472497, 429.3493945), (11501.0, 27680471.9692, 12092.5302826, 436.8614197), (643600.0, 23144040.8778, 10148.0, 438.4713998), (74600.0, 25090150.3795, 11082.1354032, 441.6926657), (571300.0, 4314754.33786, 1917.0, 444.289489), (428000.0, 73655040.8695, 33576.1108825, 455.8562521), (24201.0, 48690711.9696, 22469.9847637, 461.484005), (170200.0, 276936109.624, 128632.762786, 464.4853391), (302301.0, 6015620.63249, 2830.64159857, 470.5485554), (17701.0, 24891613.4444, 12124.1867879, 487.0791849), (11701.0, 18814581.2046, 9286.77149954, 493.5943776), (540100.0, 16406793.8483, 8162.99999999, 497.5377929), (430300.0, 7428072.87388, 3705.0, 498.7834749), (425800.0, 27462297.1462, 14216.0, 517.6551664), (8901.0, 65988343.3894, 34673.7206766, 525.4522071), (402700.0, 16743238.3692, 8863.34440023, 529.3685848), (201.0, 29648994.219, 15801.6041282, 532.9558234), (408200.0, 46951356.7647, 25452.0770203, 542.0946012), (17401.0, 30155037.6317, 16386.4226006, 543.4058084), (560200.0, 8740820.94428, 4752.33190535, 543.6940003), (250100.0, 86527319.9741, 47973.6127065, 554.4331284), (88500.0, 3045913.90412, 1700.99354236, 558.4509595), (663801.0, 32477299.0173, 18203.8525307, 560.5100511), (17201.0, 14225431.9215, 8103.23807301, 569.6303717), (526800.0, 39750174.3809, 22754.1633248, 572.4292705), (551600.0, 2270199.12222, 1302.10435916, 573.5639427), (258300.0, 31933505.8016, 18677.1556194, 584.8764534), (321700.0, 47390580.0288, 27833.3762493, 587.3187505), (515100.0, 160630199.202, 96436.7098489, 600.3647529), (660301.0, 2185715.74809, 1312.30334393, 600.399821), (323100.0, 60686961.9307, 36533.2644935999, 601.9952776), (36200.0, 104196668.533, 62845.0831675, 603.1390835), (420600.0, 15804337.0783, 9550.0, 604.26451), (661900.0, 9418216.36015, 5774.04157522, 613.0716639), (640600.0, 39525175.9433, 24255.7571638, 613.6786639), (514700.0, 18776855.2483, 11536.8011412, 614.4160451), (60800.0, 5199866.55641, 3204.93994485, 616.3504217), (443600.0, 22320424.4036, 13760.5690536, 616.501228), (340200.0, 46824760.5194, 29157.6321454, 622.6968771), (293700.0, 81041603.8575, 50553.1321394999, 623.7923453), (564600.0, 12561857.3741, 7838.0, 623.9523159), (11201.0, 4320508.5527, 2702.31361561, 625.4619295), (254200.0, 11385924.7552, 7225.48077546, 634.5976221), (411400.0, 1932821.1085, 1239.0, 641.0319064), (403300.0, 23662448.6541, 15168.5409672, 641.0385159), (19201.0, 18837986.6288, 12107.0483381, 642.693329), (571200.0, 8259714.01228, 5404.28991598, 654.2950407), (642100.0, 55661639.3049, 36713.0, 659.5745375), (15301.0, 11139833.0521, 7369.42705789, 661.5383753), (323700.0, 77567864.99, 51692.2277939, 666.412925), (132200.0, 39772750.6068, 26935.5644887, 677.2366527), (23001.0, 169133713.015, 114724.446062, 678.3061994), (12101.0, 37713159.25, 25602.7755232, 678.8817493), (5201.0, 25375193.949, 17347.6075516, 683.6443334), (340802.0, 25635768.4503, 17626.6813614, 687.5815482), (5301.0, 39467252.4903, 27283.0, 691.2819687), (400100.0, 90253486.4432, 64584.3003232, 715.5878722), (283100.0, 32774591.4032, 23453.6400413, 715.6043458), (222800.0, 19722017.4335, 14268.4555215, 723.4784965), (73300.0, 105236846.354, 76180.0865473, 723.8917659), (564200.0, 40231353.5796, 29178.9830605, 725.2796753), (277500.0, 31033953.4494, 22849.7627878, 736.282692), (406300.0, 26616832.8349, 19664.0, 738.7806101), (412300.0, 39540330.5675, 31173.5609671, 788.3990983), (645800.0, 50867713.5927, 40136.7823791, 789.0423914), (407500.0, 4903672.41172, 3883.0, 791.8555062), (282500.0, 39220159.3437, 31332.3002808, 798.882534), (22701.0, 8318490.56104, 6779.11527741, 814.9453591), (8301.0, 10349069.0763, 8451.00000001, 816.5951872), (106500.0, 28257230.3406, 23179.4782011, 820.3025534), (13801.0, 14824444.0227, 12390.2808691, 835.800712), (403000.0, 20035038.4238, 16964.0, 846.7166192), (664000.0, 49213062.5505, 44621.3766156, 906.6978217), (404400.0, 9805049.97408, 8944.00000002, 912.1830101), (15601.0, 23927938.8602, 21950.4944071, 917.3583456), (13301.0, 23675476.3431, 22019.653384, 930.0616834), (664302.0, 2893184.2892, 2693.65164821, 931.033553), (320401.0, 31976387.2148, 30092.4552678, 941.0836523), (560600.0, 9356835.22176, 8889.78866199, 950.0849861), (11801.0, 17283597.6456, 16517.8312802, 955.6940412), (276600.0, 79313837.0528, 78705.5597682, 992.3307545), (333500.0, 24724740.6648, 26172.1984337, 1058.54289), (6602.0, 22240726.9853, 23588.0978548, 1060.581242), (102400.0, 155689543.077, 165154.215242, 1060.791958), (9601.0, 14462479.1541, 15652.0, 1082.248751), (562400.0, 8703166.81321, 9601.70219384, 1103.242348), (15401.0, 20785150.4629, 22939.8424172, 1103.664968), (14201.0, 17379429.7834, 19404.0, 1116.492327), (342500.0, 22076362.3972, 24769.7527874, 1122.00336), (19801.0, 30812034.2132, 35203.0, 1142.508143), (35100.0, 171617827.665, 197065.118342, 1148.27883), (19301.0, 25859905.8165, 30863.6032405, 1193.492484), (15802.0, 4546155.81621, 5535.6244674, 1217.649524), (404200.0, 38916582.5941, 53235.6555998, 1367.942714), (19101.0, 25855955.5042, 36871.6652059, 1426.041486), (26102.0, 17290881.0843, 24887.9127813, 1439.366372), (24301.0, 45018479.6013, 67046.0, 1489.299519), (320302.0, 37171059.8536, 58296.7158628, 1568.336122), (15801.0, 4521357.58472, 7726.64155791, 1708.920698), (15501.0, 5138344.75336, 10684.6317175, 2079.391756), (558600.0, 83683995.3927, 194920.849468, 2329.248843), (219600.0, 16751854.0633, 39053.75907, 2331.309652), (14101.0, 7769413.60725, 20170.3310356, 2596.120126), (664301.0, 126190763.634, 352308.074669, 2791.868949), (559000.0, 7224283.39629, 20773.652134, 2875.531177), (26101.0, 109574352.618, 388430.348035, 3544.902057), (270101.0, 65101681.9555, 245255.356533, 3767.266055)]


# Sort List according to size
sortSecondEntry = sorted(inListWithCatchmentAndDensity, key=lambda tup: tup[1])
catchementsPosition = []
catchementsName, catchmentDimension, density = [], [], []

artificialCountr = 1

for entry in sortSecondEntry:
    catchementsPosition.append(artificialCountr)
    catchementsName.append(entry[0])
    catchmentDimension.append(entry[2])
    density.append(entry[3])
    artificialCountr += 1


plt.figure(facecolor="white")        # Remove grey background
plt.scatter(catchmentDimension, density, color="peru", marker = "o", edgecolor='black', zorder=2)


# Draw Power function
# -------------------
''''m,c,d = createPowerFit(catchmentDimension, density)
x_function = np.linspace(1000000, 0.1, 1000) # Until which value, Abastand x-axis, Number of points for creating the line
y_function_unscheduled = x_function**m * c + d
plt.plot(x_function, y_function_unscheduled, '-', color='peru')

print("m: " + str(m))
print("c: " + str(c))
print("d: " + str(d))
'''

# Data Series
ax = plt.subplot(111)

ax.xaxis.set_tick_params(width = 1.5)       # Size of ticks
ax.yaxis.set_tick_params(width = 1.5)       # Size of ticks

ax.tick_params(axis='y', direction='out')   # Ticks outwards
ax.tick_params(axis='x', direction='out')   # Ticks outwards

ax.xaxis.set_ticks_position('bottom')       # Only tiks on bottom
ax.yaxis.set_ticks_position('left')         # Only ticks on left

# Size Beschrifutn achsen
ax.tick_params(axis='y', labelsize=10)
ax.tick_params(axis='y', labelsize=10)

# no acsis on top and left
ax.spines['top'].set_visible(False)
ax.spines['right'].set_visible(False)
    
    
# Get intervall ticks
#labelPosition =  [0.5, 1,  1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5]
#newLabels = [0.5, 1,  1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5]

#ax.set_xticks(catchmentDimension, minor=False)
#ax.set_xticklabels(catchmentDimension, minor=False, visible=True, size='small')


# Moves axis
#ax.spines['left'].set_position('center')
#ax.spines['bottom'].set_position('center')
#ax.spines['left'].set_position(('data', 20000.0))
#ax.spines['bottom'].set_position(('data', 500.0))


#ax.spines['left'].set_smart_bounds(True)
#ax.spines['bottom'].set_smart_bounds(True)
#ax.xaxis.set_ticks_position('bottom')

plt.ylim(0, ) #TODO: adjust
plt.xlim(pow(10,0), ) #TODO: adjust

# Set common labels
ax.set_xlabel('Dimension [PE]', fontsize=10) # fontname="Arial"
ax.set_ylabel('Population Density [PE/km2]', fontsize=10)

ax.set_xscale('log')    # Convert Y-Axis to log-

plt.show()

# ------------
